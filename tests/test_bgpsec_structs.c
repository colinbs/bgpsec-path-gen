/*
 * Unittests that test struct initialization, appending segments
 * and freeing them.
 */

#include <stdlib.h>
#include <stdio.h>
#include <assert.h>

#include "../lib/bgpsec_structs.h"

uint8_t ski[] = {
    0x01,0x02,0x03,0x04,0x05,
    0x06,0x07,0x08,0x09,0x0A,
    0x0B,0x0C,0x0D,0x0E,0x0F,
    0x10,0x11,0x12,0x13,0x14
};

uint8_t signature[] = {
    0x01,0x02,0x03,0x04,0x05,
    0x06,0x07,0x08,0x09,0x0A,
    0x0B,0x0C,0x0D,0x0E,0x0F,
    0x10,0x11,0x12,0x13,0x14,
    0x01,0x02,0x03,0x04,0x05,
    0x06,0x07,0x08,0x09,0x0A,
    0x0B,0x0C,0x0D,0x0E,0x0F,
    0x10,0x11,0x12,0x13,0x14,
    0x01,0x02,0x03,0x04,0x05,
    0x06,0x07,0x08,0x09,0x0A,
    0x0B,0x0C,0x0D,0x0E,0x0F,
    0x10,0x11,0x12,0x13,0x14
};

static void test_init_structs(void)
{
    struct secure_path_seg *sps;
    struct signature_seg *ss;

    sps = new_sps(1, 0, 65536);
    assert(sps);

    /*signature = generate_bytes(71);*/
    ss = new_ss(ski, 60, signature);
}

int main()
{
    test_init_structs();
    printf("All tests successful!\n");
    return EXIT_SUCCESS;
}
